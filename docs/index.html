<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vexel Language</title>
  <style>
    :root {
      --bg: #0c1118;
      --panel: #111a26;
      --panel-2: #0f1622;
      --ink: #e8edf7;
      --muted: #9eacc2;
      --accent: #6ad4ff;
      --accent-2: #ffc670;
      --line: #243247;
      --ok: #7de39f;
      --danger: #ff7979;
      --shadow: 0 24px 64px rgba(0, 0, 0, 0.45);
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      background: radial-gradient(1100px 600px at 0% -20%, #143a5f44, transparent 60%),
                  radial-gradient(900px 500px at 120% 10%, #5f402144, transparent 55%),
                  var(--bg);
      color: var(--ink);
      font-family: "Avenir Next", "Segoe UI", "Helvetica Neue", Arial, sans-serif;
    }

    .wrap {
      width: min(1120px, 94vw);
      margin: 0 auto;
      padding: 20px 0 48px;
    }

    .top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 16px 0;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: linear-gradient(140deg, var(--accent) 0%, var(--accent-2) 100%);
      color: #0b1017;
      display: grid;
      place-items: center;
      font-weight: 800;
      letter-spacing: 0.02em;
    }

    .brand span {
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .nav {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 9px 14px;
      border-radius: 10px;
      border: 1px solid var(--line);
      color: var(--ink);
      text-decoration: none;
      font-size: 0.92rem;
      background: var(--panel-2);
      transition: transform .15s ease, border-color .15s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      border-color: #3b4f68;
    }

    .btn.primary {
      border-color: transparent;
      background: linear-gradient(140deg, #3ec8ff 0%, #ffc670 100%);
      color: #11151d;
      font-weight: 700;
    }

    .hero {
      margin-top: 12px;
      background: linear-gradient(180deg, #121d2b 0%, #0f1825 100%);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 26px;
      box-shadow: var(--shadow);
    }

    .hero h1 {
      margin: 0 0 10px;
      font-size: clamp(1.7rem, 3.2vw, 2.4rem);
      line-height: 1.15;
    }

    .hero p {
      margin: 0;
      color: var(--muted);
      max-width: 72ch;
      line-height: 1.5;
    }

    .hero-actions {
      margin-top: 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .grid {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 14px;
    }

    .card h3 {
      margin: 0 0 8px;
      font-size: 0.98rem;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .card p {
      margin: 0;
      color: var(--muted);
      line-height: 1.5;
      font-size: 0.93rem;
    }

    .section {
      margin-top: 26px;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 22px;
    }

    .section h2 {
      margin: 0 0 12px;
      font-size: 1.3rem;
    }

    .section p {
      color: var(--muted);
      line-height: 1.55;
      margin: 0 0 12px;
    }

    .section ul {
      margin: 0 0 12px 20px;
      padding: 0;
      color: var(--muted);
      line-height: 1.55;
    }

    .section li {
      margin: 0 0 7px;
    }

    .tutorial-step {
      margin-top: 16px;
      padding-top: 14px;
      border-top: 1px solid #223245;
    }

    pre {
      margin: 0;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid #2a3d56;
      background: #0a121d;
      color: #dfe9f8;
      font-family: "JetBrains Mono", "IBM Plex Mono", ui-monospace, monospace;
      font-size: 0.9rem;
      overflow-x: auto;
      line-height: 1.45;
    }

    code {
      font-family: "JetBrains Mono", "IBM Plex Mono", ui-monospace, monospace;
      background: #172232;
      border: 1px solid #2f435e;
      border-radius: 7px;
      padding: 1px 6px;
      color: #d3e2f8;
    }

    .tutorial-step h3 {
      margin: 0 0 8px;
      font-size: 1rem;
      color: var(--accent-2);
    }

    .code-title {
      margin: 8px 0 8px;
      font-size: 0.9rem;
      color: var(--muted);
      letter-spacing: 0.02em;
    }

    .playground-frame {
      margin-top: 12px;
      border: 1px solid var(--line);
      border-radius: 12px;
      width: 100%;
      min-height: 680px;
      background: #0b1119;
    }

    .status {
      margin-top: 10px;
      font-size: 0.92rem;
      color: var(--muted);
    }

    .status.ok { color: var(--ok); }
    .status.error { color: var(--danger); }

    .foot {
      margin-top: 18px;
      color: var(--muted);
      font-size: 0.9rem;
      text-align: center;
    }

    @media (max-width: 980px) {
      .grid {
        grid-template-columns: 1fr;
      }
      .playground-frame {
        min-height: 520px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="top">
      <div class="brand">
        <div class="logo">V</div>
        <span>Vexel Language</span>
      </div>
      <nav class="nav">
        <a class="btn" href="#tutorial">Tutorial</a>
        <a class="btn" href="vexel-rfc.md">RFC</a>
        <a class="btn" href="../README.md">Repository Guide</a>
        <a class="btn primary" href="playground.html">Open Playground</a>
      </nav>
    </header>

    <section class="hero">
      <h1>Whole-program language built for aggressive compile-time execution</h1>
      <p>
        Vexel is intentionally constrained so the frontend can model the full program graph,
        execute compile-time paths deeply, and remove dead code before backend emission.
        The C backend is reference-grade; additional backends can diverge in implementation strategy.
      </p>
      <div class="hero-actions">
        <a class="btn primary" href="playground.html">Launch Playground</a>
        <a class="btn" href="vexel-rfc.md">Read Specification</a>
      </div>
    </section>

    <section class="grid">
      <article class="card">
        <h3>Core Model</h3>
        <p>No pointers, no heap allocation, no implicit standard API, and whole-program visibility.</p>
      </article>
      <article class="card">
        <h3>Frontend Ownership</h3>
        <p>Compile-time execution, analysis, type soundness, and dead-code elimination are frontend responsibilities.</p>
      </article>
      <article class="card">
        <h3>Backend Contract</h3>
        <p>Backends consume analyzed/residualized AST and frontend facts. They do not define language semantics.</p>
      </article>
    </section>

    <section class="section" id="tutorial">
      <h2>Language Tutorial</h2>
      <p>
        This page is a practical tour of Vexel syntax and workflow. It starts from a tiny program and
        ends at backend-oriented output inspection.
      </p>
      <p>
        Tutorial sources live in <code>examples/tutorial/</code>. You can open each directly in the playground:
        <a href="playground.html?file=examples/tutorial/quickadd.vx&backend=c">quickadd</a>,
        <a href="playground.html?file=examples/tutorial/hello.vx&backend=c">hello</a>,
        <a href="playground.html?file=examples/tutorial/globals.vx&backend=c">globals</a>,
        <a href="playground.html?file=examples/tutorial/exports.vx&backend=c">exports</a>,
        <a href="playground.html?file=examples/tutorial/typeof_demo.vx&backend=c">typeof</a>,
        <a href="playground.html?file=examples/tutorial/iteration.vx&backend=c">iteration</a>,
        <a href="playground.html?file=examples/tutorial/structs.vx&backend=c">structs</a>,
        <a href="playground.html?file=examples/tutorial/constexpr_dce.vx&backend=c">constexpr_dce</a>,
        <a href="playground.html?file=examples/tutorial/sieve.vx&backend=c">sieve</a>,
        <a href="playground.html?file=examples/tutorial/matrix_sum.vx&backend=c">matrix_sum</a>,
        <a href="playground.html?file=examples/tutorial/abi_hints.vx&backend=c">abi_hints</a>,
        <a href="playground.html?file=examples/tutorial/reentrant.vx&backend=c">reentrant</a>,
        <a href="playground.html?file=examples/tutorial/multifile/main.vx&backend=c">multifile</a>.
      </p>

      <div class="tutorial-step">
        <h3>1) Program shape and ABI boundaries</h3>
        <p>
          Function declarations use <code>&amp;</code>. Entry points/exports use <code>&amp;^</code>.
          External function imports use <code>&amp;!</code>. Global imports use <code>!</code> (external symbol)
          or <code>!!</code> (backend-bound binding).
        </p>
        <pre><code>&amp;!putchar(c:#u8);
!PORT:#u8;
[[addr(0x4000)]]
!!CTRL:#u8;

&amp;print_char(c:#u8) {
  putchar(c);
  CTRL = PORT
}

&amp;^main() -&gt; #i32 {
  print_char(65);
  0
}</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>2) Types, literals, and declarations</h3>
        <p>
          Primitive types are explicit (<code>#b</code>, <code>#iN</code>, <code>#uN</code>, <code>#f16/#f32/#f64</code>, <code>#s</code>).
          Frontend accepts any positive integer width; backends can support subsets (for C/megalinker: 8/16/32/64).
        </p>
        <pre><code>flag:#b = 1;
count:#i27 = -10;
size:#u13 = 4095;
name:#s = "Vexel";
bytes:#u8[4] = [1, 2, 3, 4];</code></pre>
        <p>
          Type expressions are supported with <code>#[expr]</code> and use the static type of <code>expr</code>.
        </p>
        <pre><code>seed:#u16 = 42;
table:#[seed][8];
value:#[seed] = 7;</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>3) Control flow, loops, and iteration</h3>
        <p>
          Conditionals can be expression-level (<code>a ? b : c</code>) or block-style. Loops use <code>@{ ... }</code>.
        </p>
        <pre><code>&amp;^main() -&gt; #i32 {
  sum:#i32 = 0;
  i:#i32 = 0;
  (i &lt; 4)@{
    sum = sum + i;
    i = i + 1;
  };
  sum
}</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>4) Structs, methods, and operators</h3>
        <p>
          Named structs use <code>#Type(...)</code>. Methods use receiver syntax.
        </p>
        <pre><code>#Vec2(x:#i32, y:#i32);

&amp;(self)#Vec2::len2() -&gt; #i32 {
  self.x * self.x + self.y * self.y
}

&amp;(lhs)#Vec2::+(rhs:#Vec2) -&gt; #Vec2 {
  Vec2(lhs.x + rhs.x, lhs.y + rhs.y)
}</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>5) Compile-time execution and dead-code elimination</h3>
        <p>
          Pure call chains can be folded at compile time; unreachable or unused declarations are removed before backend emission.
        </p>
        <pre><code>&amp;mul(a:#i32, b:#i32) -&gt; #i32 { a * b }
&amp;add(a:#i32, b:#i32) -&gt; #i32 { a + b }

result:#i32 = add(mul(6, 7), 0);
dead:#i32 = mul(9, 9);

&amp;^main() -&gt; #i32 { result }</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>6) Multi-file modules</h3>
        <p>Use module imports and keep related logic in separate files.</p>
        <div class="code-title">main.vx</div>
        <pre><code>::math;

&amp;^main() -&gt; #i32 {
  add(20, 22)
}</code></pre>
        <div class="code-title">math.vx</div>
        <pre><code>&amp;add(a:#i32, b:#i32) -&gt; #i32 {
  a + b
}</code></pre>
      </div>

      <div class="tutorial-step">
        <h3>7) Backend hints (annotation pass-through)</h3>
        <p>
          Frontend parses annotations but does not globally whitelist them. Backend-specific hints are consumed by the selected backend.
        </p>
        <ul>
          <li><code>[[nonreentrant]]</code>: recognized by C and megalinker on ABI boundaries.</li>
          <li><code>[[nonbanked]]</code>: recognized by megalinker for global placement.</li>
          <li><code>[[sdcccall(0)]]</code> / <code>[[sdcccall(1)]]</code>: recognized by megalinker on <code>&amp;!</code> and <code>&amp;^</code>.</li>
          <li><code>[[addr(...)]]</code> / <code>[[address(...)]]</code>: recognized by C and megalinker for <code>!!</code> bindings.</li>
        </ul>
      </div>

      <div class="tutorial-step">
        <h3>8) Compile and inspect outputs</h3>
        <p>The unified driver always requires a backend.</p>
        <pre><code>./build/vexel -b c -o out path/to/main.vx
./build/vexel -b megalinker -o out path/to/main.vx
./build/vexel -b vexel -o out path/to/main.vx</code></pre>
        <p>
          Run <code>./build/vexel --help</code> to see frontend flags and backend-specific options for all discovered backends.
        </p>
      </div>
    </section>

    <section class="section" id="playground">
      <h2>Playground</h2>
      <p>
        The embedded frame below loads <code>docs/playground.html</code>.
        If it is not present in your local checkout yet, use the button to open it after running <code>make web</code>.
      </p>
      <div class="hero-actions">
        <a class="btn primary" href="playground.html">Open playground.html</a>
      </div>
      <div id="playgroundStatus" class="status">Checking playground availability...</div>
      <iframe id="playgroundFrame" class="playground-frame" src="playground.html" title="Vexel Playground"></iframe>
    </section>

    <div class="foot">
      Vexel docs front page is source-controlled. Playground payload is generated separately.
    </div>
  </div>

  <script>
    (function () {
      const frame = document.getElementById("playgroundFrame");
      const status = document.getElementById("playgroundStatus");

      fetch("playground.html", { method: "HEAD" })
        .then((response) => {
          if (!response.ok) {
            throw new Error("missing");
          }
          status.textContent = "Playground available.";
          status.classList.add("ok");
        })
        .catch(() => {
          status.textContent = "playground.html is not present locally yet. Run 'make web' or wait for GitHub Pages deploy.";
          status.classList.add("error");
          frame.removeAttribute("src");
          frame.setAttribute("title", "Playground not available");
        });
    })();
  </script>
</body>
</html>
